# Futbol Tahmin Web Uygulaması - Sistem Dokümantasyonu

## Proje Genel Bakış

Bu proje, Flask tabanlı bir futbol tahmin web uygulamasıdır. API Football v3 entegrasyonu ile gerçek zamanlı maç verileri alır ve makine öğrenmesi algoritmaları ile tahminler üretir.

## API'den Tahmin Üretiminde Kullanılan Veri Kaynakları

### 1. Takım Form Analizi Verileri

#### Son Maç Verileri (Değişken Periyotlar)
- **Son 3 Maç:** En yüksek ağırlık (weight: 2.5)
- **Son 6 Maç:** Orta ağırlık (weight: 1.5) 
- **Son 9 Maç:** En düşük ağırlık (weight: 1.0)

#### Ev Sahibi Takım Performans Metrikleri
```python
home_performance = {
    'avg_goals_scored': 1.8,           # Ev sahibiyken ortalama attığı gol
    'avg_goals_conceded': 0.9,         # Ev sahibiyken ortalama yediği gol
    'avg_ht_goals_scored': 0.8,        # İlk yarı ortalama gol
    'avg_ht_goals_conceded': 0.4,      # İlk yarı ortalama yenen gol
    'form_points': 0.75,               # Form puanı (0-1 arası)
    'weighted_avg_goals_scored': 1.9,   # Ağırlıklı gol ortalaması
    'weighted_avg_goals_conceded': 0.8, # Ağırlıklı yenen gol ortalaması
    'weighted_form_points': 0.82       # Ağırlıklı form puanı
}
```

#### Deplasman Takım Performans Metrikleri
```python
away_performance = {
    'avg_goals_scored': 1.2,           # Deplasmanda ortalama attığı gol
    'avg_goals_conceded': 1.1,         # Deplasmanda ortalama yediği gol
    'avg_ht_goals_scored': 0.6,        # İlk yarı ortalama gol
    'avg_ht_goals_conceded': 0.5,      # İlk yarı ortalama yenen gol
    'form_points': 0.60,               # Form puanı (0-1 arası)
    'weighted_avg_goals_scored': 1.3,   # Ağırlıklı gol ortalaması
    'weighted_avg_goals_conceded': 1.0, # Ağırlıklı yenen gol ortalaması
    'weighted_form_points': 0.65       # Ağırlıklı form puanı
}
```

### 2. Bayesian Analiz Parametreleri

#### Lambda Değerleri (Poisson Dağılımı)
```python
bayesian_params = {
    'home_lambda_scored': 1.63,        # Ev sahibi saldırı gücü
    'home_lambda_conceded': 1.20,      # Ev sahibi savunma zaafiyeti
    'away_lambda_scored': 1.31,        # Deplasman saldırı gücü
    'away_lambda_conceded': 1.03,      # Deplasman savunma zaafiyeti
    'n_home': 8,                       # Ev sahibi maç sayısı
    'n_away': 11                       # Deplasman maç sayısı
}
```

### 3. İlk Yarı/Maç Sonu İstatistikleri

#### HT/FT Kombinasyonları
```python
ht_ft_stats = {
    '1/1': 5,  # İY: Ev Önde → MS: Ev Galip
    '1/2': 0,  # İY: Ev Önde → MS: Deplasman Galip
    '1/X': 0,  # İY: Ev Önde → MS: Beraberlik
    '2/1': 2,  # İY: Deplasman Önde → MS: Ev Galip
    '2/2': 1,  # İY: Deplasman Önde → MS: Deplasman Galip
    '2/X': 1,  # İY: Deplasman Önde → MS: Beraberlik
    'X/1': 1,  # İY: Beraberlik → MS: Ev Galip
    'X/2': 1,  # İY: Beraberlik → MS: Deplasman Galip
    'X/X': 0   # İY: Beraberlik → MS: Beraberlik
}
```

### 4. Monte Carlo Simülasyon Parametreleri

#### Simülasyon Ayarları
- **Simülasyon Sayısı:** 10,000 iterasyon
- **Rastgele Seed:** Takım ID'lerinden türetilen deterministic değer
- **Gol Dağılımı:** Poisson dağılımı (ayarlanmış lambda değerleri ile)

#### Form Faktörleri
```python
form_adjustments = {
    'home_attack_strength': 1.0 + min(0.25, (avg_home_goals - 1.5) * 0.1),
    'home_defense_weakness': 1.0 + min(0.3, (away_conceded_avg - 1.0) * 0.15),
    'away_attack_strength': 1.0 + min(0.25, (avg_away_goals - 1.2) * 0.1),
    'away_defense_weakness': 1.0 + min(0.3, (home_conceded_avg - 0.8) * 0.15)
}
```

### 5. Detaylı Maç Verileri

#### Her Maç İçin Kaydedilen Bilgiler
```python
match_data = {
    'date': '2025-06-19',
    'ft_result': 'W',  # W (Win), L (Loss), D (Draw)
    'goals_scored': 2,
    'goals_conceded': 0,
    'ht_ft_code': '1/1',
    'ht_goals_scored': 1,
    'ht_goals_conceded': 0,
    'home': True,  # Ev sahibi mi
    'opponent_quality': 'medium',  # low, medium, high
    'venue': 'home'  # home, away
}
```

### 6. Takım Gücü Analizi

#### Rakip Analizi Metrikleri
```python
opponent_analysis = {
    'power_difference': 0.15,          # Güç farkı (-1 ile 1 arası)
    'home_advantage': 0.12,            # Ev sahibi avantajı
    'relative_strength': 0.577,        # Göreceli güç (0-1 arası)
    'stronger_team': 'AWAY',           # Güçlü takım
    'strength_category': 'slight'       # minimal, slight, moderate, significant
}
```

### 7. Head-to-Head (Kafa Kafaya) Veriler

#### Geçmiş Karşılaşma İstatistikleri
```python
h2h_analysis = {
    'total_matches': 5,
    'home_wins': 2,
    'away_wins': 2,
    'draws': 1,
    'avg_home_goals': 1.4,
    'avg_away_goals': 1.2,
    'recent_matches': [
        {'home_goals': 2, 'away_goals': 1, 'date': '2024-12-15'},
        {'home_goals': 0, 'away_goals': 1, 'date': '2024-08-20'}
    ]
}
```

### 8. Ağırlıklandırma Sistemi

#### Zaman Bazlı Ağırlıklar
- **Son 5 Maç:** %50 ağırlık (2.5x multiplier)
- **6-10 Arası Maçlar:** %30 ağırlık (1.5x multiplier)
- **11-21 Arası Maçlar:** %20 ağırlık (1.0x multiplier)

#### Model Kombinasyon Ağırlıkları
- **Bayesian Analiz:** %60
- **Ağırlıklı Ortalama:** %40
- **H2H Etkisi:** %30 (3+ maç varsa)
- **Monte Carlo Simülasyonu:** %50
- **Teorik Poisson:** %50

### 9. Bahis Tahmin Faktörleri

#### KG VAR/YOK (Both Teams to Score)
```python
kg_var_factors = {
    'simulation_probability': 0.4862,   # Monte Carlo sonucu
    'theoretical_probability': 0.4523,  # Poisson teorik
    'combined_probability': 0.4692,     # Birleşik olasılık
    'historical_rate': 0.45,           # Takımların geçmiş KG VAR oranı
    'goal_expectation_factor': 1.2     # Gol beklentisi çarpanı
}
```

#### 2.5 ÜST/ALT (Over/Under Goals)
```python
over_under_factors = {
    'total_expected_goals': 3.22,      # Toplam beklenen gol
    'simulation_over_prob': 0.65,      # Simülasyon ÜST olasılığı
    'poisson_over_prob': 0.62,         # Poisson ÜST olasılığı
    'combined_over_prob': 0.635,       # Birleşik ÜST olasılığı
    'goal_variance': 1.85              # Gol varyansı
}
```

### 10. Kesin Skor Tahmin Mekanizması

#### En Olası Skorlar (Monte Carlo'dan)
```python
most_likely_scores = {
    '1-3': {'probability': 14.26, 'frequency': 1426},
    '0-2': {'probability': 12.15, 'frequency': 1215},
    '1-2': {'probability': 11.84, 'frequency': 1184},
    '0-1': {'probability': 10.92, 'frequency': 1092},
    '2-3': {'probability': 8.73, 'frequency': 873}
}
```

### 11. Neural Network Girdi Verileri

#### Sinir Ağı Özellik Vektörü
```python
neural_features = [
    avg_home_goals,          # Ev sahibi gol ortalaması
    avg_away_goals,          # Deplasman gol ortalaması
    home_form_points,        # Ev sahibi form puanı
    away_form_points,        # Deplasman form puanı
    goal_difference,         # Gol farkı ortalaması
    home_attack_strength,    # Ev sahibi saldırı gücü
    away_defense_weakness,   # Deplasman savunma zaafiyeti
    h2h_home_win_rate,      # H2H ev sahibi galibiyet oranı
    recent_momentum,         # Son dönem momentum
    league_position_diff     # Lig sıralaması farkı
]
```

### 12. Dinamik Faktör Hesaplamaları

#### Anlık Güç Değerlendirmesi
```python
dynamic_factors = {
    'home_current_form': 0.82,         # Güncel ev sahibi form
    'away_current_form': 0.65,         # Güncel deplasman form
    'momentum_difference': 0.17,        # Momentum farkı
    'goal_scoring_trend': 'increasing', # Gol atma trendi
    'defensive_stability': 'moderate',   # Savunma istikrarı
    'injury_impact': 0.05,             # Sakatlık etkisi (tahmin)
    'weather_factor': 1.0              # Hava durumu etkisi
}
```

Bu veriler API Football v3'ten gerçek zamanlı olarak alınır ve her tahmin için yukarıdaki algoritmalar ile işlenerek nihai tahminler üretilir.

## API v3 Veri Çekme Süreci ve Fonksiyon Hiyerarşisi

### 1. Tahmin Butonu Basıldıktan Sonra İşlem Akışı

#### Frontend JavaScript Süreci
```javascript
// static/js/fixed_custom.js
showPrediction(homeTeamId, awayTeamId, homeTeamName, awayTeamName, forceUpdate)
↓
fetch(`/api/predict-match/${homeTeamId}/${awayTeamId}?home_name=${homeTeamName}&away_name=${awayTeamName}&force_update=${forceUpdate}`)
↓
updatePredictionUI(data) // API yanıtını işle ve UI'ı güncelle
```

#### Örnek API Çağrısı
```javascript
// Gerçek örnek:
showPrediction("4700", "8847", "Leiknir", "Njardvik", false)
// Bu çağrı şu URL'ye gider:
// /api/predict-match/4700/8847?home_name=Leiknir&away_name=Njardvik&force_update=false
```

### 2. Backend API Endpoint Hiyerarşisi

#### Ana Tahmin Endpoint'i
```python
# api_routes.py
@app.route('/api/predict-match/<int:home_team_id>/<int:away_team_id>')
def api_v3_predict_match(home_team_id, away_team_id):
    ↓
    # 1. Önbellek kontrolü
    cache_key = f"prediction_{home_team_id}_{away_team_id}"
    
    ↓
    # 2. Ana tahmin fonksiyonunu çağır
    predictor = MatchPredictor()
    prediction_result = predictor.predict_match_v3(
        home_team_id=home_team_id,
        away_team_id=away_team_id,
        home_team_name=home_name,
        away_team_name=away_name
    )
```

### 3. API Football v3 Veri Çekme Fonksiyonları

#### Takım İstatistikleri Çekme
```python
# api_routes.py
def get_team_stats_api(team_id):
    """API v3'ten takım istatistiklerini çek"""
    
    # 1. API endpoint'i oluştur
    url = f"https://v3.football.api-sports.io/teams/statistics"
    
    # 2. Parametreler
    params = {
        'team': team_id,
        'season': 2024,  # Güncel sezon
        'league': league_id  # Takımın oynadığı lig
    }
    
    # 3. Headers (API Key ile)
    headers = {
        'X-RapidAPI-Key': APIFOOTBALL_PREMIUM_KEY,
        'X-RapidAPI-Host': 'v3.football.api-sports.io'
    }
    
    # 4. API çağrısı
    response = requests.get(url, headers=headers, params=params)
    
    # 5. Veri işleme
    if response.status_code == 200:
        data = response.json()['response']
        return process_team_statistics(data)
```

#### Takım Son Maçları Çekme
```python
# api_routes.py
def get_team_matches(team_id):
    """Takımın son maçlarını API v3'ten çek"""
    
    # 1. API endpoint'i
    url = f"https://v3.football.api-sports.io/fixtures"
    
    # 2. Parametreler - Son 10 maç
    params = {
        'team': team_id,
        'last': 10,
        'status': 'FT'  # Sadece bitmiş maçlar
    }
    
    # 3. API çağrısı ve veri işleme
    response = requests.get(url, headers=headers, params=params)
    matches = response.json()['response']
    
    # 4. Her maç için detaylı analiz
    processed_matches = []
    for match in matches:
        processed_match = {
            'date': match['fixture']['date'],
            'home_team': match['teams']['home'],
            'away_team': match['teams']['away'],
            'home_goals': match['goals']['home'],
            'away_goals': match['goals']['away'],
            'halftime_home': match['score']['halftime']['home'],
            'halftime_away': match['score']['halftime']['away']
        }
        processed_matches.append(processed_match)
    
    return processed_matches
```

### 4. Ana Tahmin Fonksiyon Hiyerarşisi

#### MatchPredictor.predict_match_v3()
```python
# match_prediction.py
def predict_match_v3(self, home_team_id, away_team_id, home_team_name, away_team_name):
    
    # 1. Takım verilerini çek
    home_matches = self.get_team_recent_matches_v3(home_team_id)
    away_matches = self.get_team_recent_matches_v3(away_team_id)
    
    ↓
    # 2. Form analizi yap
    home_form = self.analyze_team_form_v3(home_matches, True)  # True = ev sahibi
    away_form = self.analyze_team_form_v3(away_matches, False)  # False = deplasman
    
    ↓
    # 3. Bayesian analiz
    bayesian_result = self.bayesian_analysis_v3(home_form, away_form)
    
    ↓
    # 4. Monte Carlo simülasyonu
    monte_carlo_result = self.monte_carlo_simulation_v3(
        home_lambda=bayesian_result['home_lambda'],
        away_lambda=bayesian_result['away_lambda']
    )
    
    ↓
    # 5. Tahmin sonuçlarını birleştir
    final_prediction = self.combine_predictions_v3(
        bayesian_result, 
        monte_carlo_result, 
        home_form, 
        away_form
    )
    
    ↓
    # 6. Frontend için formatla
    return self.format_prediction_for_frontend_v3(final_prediction)
```

### 5. API Veri İşleme Fonksiyonları

#### Form Analizi
```python
def analyze_team_form_v3(self, matches, is_home_team):
    """Takım formunu analiz et"""
    
    form_data = {
        'recent_matches': [],
        'goals_scored': [],
        'goals_conceded': [],
        'results': [],
        'venues': []
    }
    
    # Her maç için
    for match in matches:
        # Takımın ev sahibi mi deplasman mı olduğunu belirle
        if match['teams']['home']['id'] == team_id:
            # Ev sahibi
            goals_for = match['goals']['home']
            goals_against = match['goals']['away']
            venue = 'home'
        else:
            # Deplasman
            goals_for = match['goals']['away'] 
            goals_against = match['goals']['home']
            venue = 'away'
        
        # Sonuç hesapla
        if goals_for > goals_against:
            result = 'W'  # Win
        elif goals_for < goals_against:
            result = 'L'  # Loss
        else:
            result = 'D'  # Draw
        
        # Form verisine ekle
        form_data['goals_scored'].append(goals_for)
        form_data['goals_conceded'].append(goals_against)
        form_data['results'].append(result)
        form_data['venues'].append(venue)
    
    # Ortalamalar ve ağırlıklı hesaplamalar
    return calculate_weighted_averages(form_data)
```

#### Bayesian Analiz
```python
def bayesian_analysis_v3(self, home_form, away_form):
    """Bayesian yaklaşımla lambda değerlerini hesapla"""
    
    # 1. Liga genel ortalamaları (API'den veya varsayılan)
    league_avg_home_goals = 1.5
    league_avg_away_goals = 1.2
    
    # 2. Takım gücü faktörleri
    home_attack_strength = home_form['avg_goals_scored'] / league_avg_home_goals
    home_defense_strength = league_avg_away_goals / home_form['avg_goals_conceded']
    
    away_attack_strength = away_form['avg_goals_scored'] / league_avg_away_goals
    away_defense_strength = league_avg_home_goals / away_form['avg_goals_conceded']
    
    # 3. Lambda değerleri (Poisson dağılımı için)
    home_lambda = league_avg_home_goals * home_attack_strength * away_defense_strength
    away_lambda = league_avg_away_goals * away_attack_strength * home_defense_strength
    
    return {
        'home_lambda': home_lambda,
        'away_lambda': away_lambda,
        'home_attack_strength': home_attack_strength,
        'away_defense_strength': away_defense_strength
    }
```

### 6. Monte Carlo Simülasyon

#### Simülasyon Süreci
```python
def monte_carlo_simulation_v3(self, home_lambda, away_lambda, simulations=10000):
    """Monte Carlo simülasyonu yap"""
    
    import random
    
    # 1. Deterministic seed (tutarlı sonuçlar için)
    seed = (home_team_id * 1000 + away_team_id) % 2147483647
    random.seed(seed)
    
    # 2. Simülasyon sonuçları
    results = {
        'home_wins': 0,
        'draws': 0,
        'away_wins': 0,
        'both_teams_score': 0,
        'over_2_5': 0,
        'over_3_5': 0,
        'exact_scores': {}
    }
    
    # 3. 10,000 simülasyon
    for _ in range(simulations):
        # Poisson dağılımından gol sayıları
        home_goals = poisson_random(home_lambda)
        away_goals = poisson_random(away_lambda)
        
        # Sonuçları kaydet
        if home_goals > away_goals:
            results['home_wins'] += 1
        elif away_goals > home_goals:
            results['away_wins'] += 1
        else:
            results['draws'] += 1
        
        # Diğer bahis pazarları
        if home_goals > 0 and away_goals > 0:
            results['both_teams_score'] += 1
        
        total_goals = home_goals + away_goals
        if total_goals > 2.5:
            results['over_2_5'] += 1
        if total_goals > 3.5:
            results['over_3_5'] += 1
        
        # Kesin skor
        score = f"{home_goals}-{away_goals}"
        results['exact_scores'][score] = results['exact_scores'].get(score, 0) + 1
    
    # 4. Olasılıkları hesapla
    for key in ['home_wins', 'draws', 'away_wins', 'both_teams_score', 'over_2_5', 'over_3_5']:
        results[key] = results[key] / simulations
    
    return results
```

### 7. Frontend'e Veri Gönderimi

#### Final API Yanıtı Formatı
```python
def format_prediction_for_frontend_v3(self, prediction_data):
    """Frontend için veriyi formatla"""
    
    return {
        'home_team': {
            'id': home_team_id,
            'name': home_team_name
        },
        'away_team': {
            'id': away_team_id,
            'name': away_team_name
        },
        'most_likely_outcome': determine_most_likely_outcome(prediction_data),
        'exact_score': get_most_likely_score(prediction_data['exact_scores']),
        'predictions': {
            'betting_predictions': {
                'both_teams_to_score': {
                    'prediction': 'KG VAR' if prediction_data['both_teams_score'] > 0.5 else 'KG YOK',
                    'probability': round(prediction_data['both_teams_score'] * 100, 1)
                },
                'over_2_5_goals': {
                    'prediction': '2.5 ÜST' if prediction_data['over_2_5'] > 0.5 else '2.5 ALT',
                    'probability': round(prediction_data['over_2_5'] * 100, 1)
                },
                'match_winner': {
                    'prediction': determine_winner(prediction_data),
                    'home_win_prob': round(prediction_data['home_wins'] * 100, 1),
                    'draw_prob': round(prediction_data['draws'] * 100, 1),
                    'away_win_prob': round(prediction_data['away_wins'] * 100, 1)
                }
            }
        },
        'analysis': {
            'home_form': home_form_analysis,
            'away_form': away_form_analysis,
            'bayesian_params': bayesian_result,
            'simulation_summary': monte_carlo_summary
        }
    }
```

### 8. Kullanılan API v3 Endpoint'leri

#### Takım İstatistikleri
```
GET https://v3.football.api-sports.io/teams/statistics
Parameters:
- team: {team_id}
- season: 2024
- league: {league_id}
```

#### Takım Son Maçları
```
GET https://v3.football.api-sports.io/fixtures
Parameters:
- team: {team_id}
- last: 10
- status: 'FT'
```

#### Fikstür Listesi
```
GET https://v3.football.api-sports.io/fixtures
Parameters:
- date: {YYYY-MM-dd}
- timezone: 'Europe/Istanbul'
```

#### Takım Detay Bilgileri
```
GET https://v3.football.api-sports.io/teams
Parameters:
- id: {team_id}
```

### 9. Hata Yönetimi ve Fallback

#### API Hata Durumları
```python
def get_team_stats_with_fallback(team_id):
    """Ana API başarısız olursa yedek sistemler"""
    
    try:
        # 1. Ana API v3 çağrısı
        return get_team_stats_api(team_id)
    except Exception as e:
        logger.warning(f"Ana API başarısız: {e}")
        
        try:
            # 2. Yedek API endpoint
            return get_team_stats_backup(team_id)
        except Exception as e2:
            logger.warning(f"Yedek API başarısız: {e2}")
            
            # 3. Varsayılan değerler
            return get_team_stats_dummy(team_id)
```

Bu hiyerarşik yapı sayesinde sistem, kullanıcı tahmin butonuna bastığında otomatik olarak API v3'ten veri çeker, işler ve frontend'e gönderir.

## Sistem Replikasyonu İçin Gerekli Dosyalar ve Ayarlar

### 1. Temel Dosya Yapısı
```
├── main.py                    # Flask uygulaması entry point
├── match_prediction.py        # Ana tahmin motoru
├── api_routes.py             # API endpoint'leri
├── football_api_config.py    # API konfigürasyon
├── safe_imports.py           # Güvenli import yönetimi
├── requirements.txt          # Python bağımlılıkları
├── templates/
│   ├── base.html
│   ├── index.html
│   └── fixtures.html
├── static/js/
│   ├── fixed_custom.js       # Ana tahmin JavaScript
│   └── custom.js
└── static/css/
    └── style.css
```

### 2. Kritik Environment Variables
```bash
# .env dosyası
APIFOOTBALL_PREMIUM_KEY=your_api_key_here
SESSION_SECRET=your_session_secret
DATABASE_URL=sqlite:///predictions.db
```

### 3. Python Requirements
```txt
flask==2.3.3
requests==2.31.0
gunicorn==21.2.0
flask-cors==4.0.0
flask-caching==2.1.0
flask-sqlalchemy==3.0.5
numpy==1.24.3
pandas==2.0.3
scikit-learn==1.3.0
tensorflow==2.13.0
```

### 4. API Key Alımı (API Football v3)
1. https://rapidapi.com/api-sports/api/api-football/ adresine git
2. Premium plan subscribe ol (aylık $10-50 arası)
3. API key'i al ve environment variable olarak ayarla
4. Günlük quota limitlerini kontrol et (premium: 1000+ request/day)

### 5. Flask Uygulaması Konfigürasyonu
```python
# main.py
from flask import Flask
from flask_cors import CORS
import os

app = Flask(__name__)
app.secret_key = os.environ.get("SESSION_SECRET", "your-secret-key")
CORS(app)

# API routes'ları import et
from api_routes import *

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)
```

### 6. Gunicorn Deployment
```bash
# Production'da çalıştırma
gunicorn --bind 0.0.0.0:5000 --reuse-port --reload main:app

# Process sayısını artırma
gunicorn --bind 0.0.0.0:5000 --workers 4 --threads 2 main:app
```

### 7. Veritabanı Kurulumu (Opsiyonel)
```python
# models.py (Eğer veritabanı kullanacaksan)
from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

class PredictionCache(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    match_key = db.Column(db.String(100), unique=True)
    prediction_data = db.Column(db.Text)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
```

### 8. Frontend Integration
```html
<!-- templates/base.html -->
<script src="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
<script src="{{ url_for('static', filename='js/fixed_custom.js') }}?v=1">
```

### 9. API Rate Limiting
```python
# api_routes.py
import time
from functools import wraps

def rate_limit(calls_per_minute=60):
    def decorator(f):
        @wraps(f)
        def wrapper(*args, **kwargs):
            # Rate limiting logic
            return f(*args, **kwargs)
        return wrapper
    return decorator

@rate_limit(calls_per_minute=30)
def get_team_stats_api(team_id):
    # API çağrısı
    pass
```

### 10. Error Handling ve Logging
```python
import logging

# Logging konfigürasyonu
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# Hata yakalama
try:
    result = api_call()
except Exception as e:
    logger.error(f"API çağrısı başarısız: {e}")
    return fallback_data()
```

### 11. Cache Sistemi
```python
from flask_caching import Cache

cache = Cache()
cache.init_app(app, config={
    'CACHE_TYPE': 'simple',
    'CACHE_DEFAULT_TIMEOUT': 300  # 5 dakika
})

@cache.cached(timeout=300, key_prefix='prediction')
def get_prediction(home_id, away_id):
    return expensive_prediction_calculation()
```

### 12. Testing ve Validation
```python
# test_predictions.py
import unittest

class TestPredictions(unittest.TestCase):
    def test_api_response_format(self):
        predictor = MatchPredictor()
        result = predictor.predict_match_v3(123, 456, "Team A", "Team B")
        
        self.assertIn('predictions', result)
        self.assertIn('betting_predictions', result['predictions'])
        
    def test_monte_carlo_consistency(self):
        # Aynı takımlar için tutarlı sonuç
        result1 = monte_carlo_simulation(1.5, 1.2, home_id=123, away_id=456)
        result2 = monte_carlo_simulation(1.5, 1.2, home_id=123, away_id=456)
        
        self.assertEqual(result1['exact_score'], result2['exact_score'])
```

### 13. Deployment Checklist
- [ ] API key environment variable olarak ayarlandı
- [ ] Requirements.txt bağımlılıkları yüklendi
- [ ] Flask uygulaması çalışıyor (localhost:5000)
- [ ] API endpoint'leri test edildi (/api/predict-match/123/456)
- [ ] Frontend JavaScript dosyaları yüklendi
- [ ] CSS stilleri uygulandı
- [ ] Error handling ve logging aktif
- [ ] Production server'da HTTPS aktif
- [ ] Rate limiting yapılandırıldı

### 14. Diğer AI'lar için Kritik Notlar
```
UYARI: Bu sistem replikasyonu yaparken:

1. Monte Carlo simülasyonunda MUTLAKA deterministic seed kullan:
   seed = (home_team_id * 1000 + away_team_id) % 2147483647

2. KG VAR/YOK kararını SKORDAN ALMA, Monte Carlo sonuçlarını kullan

3. API yanıt formatını AYNEN koru, frontend beklentilerini karşılamalı

4. Poisson dağılımı için lambda değerlerini BAYESIAN ANALİZ ile hesapla

5. Form analizi yaparken ağırlıklı ortalama kullan (son maçlar daha önemli)

6. API rate limiting MUTLAKA uygula, aksi halde hesap banlanabilir

7. Hata durumlarında fallback data yerine API key istemeyi tercih et

8. Cache sistemi kullanarak aynı tahminleri tekrar tekrar hesaplama
```

Bu dokümantasyonla birlikte, sistemin tam kopyası oluşturulabilir ve diğer AI'lar bu hiyerarşik yapıyı takip ederek aynı sonuçları elde edebilir.

## Takım Gol Beklentileri ve Kesin Skor Hesaplama Algoritmaları

### 1. Gol Beklentisi Hesaplama Hiyerarşisi

#### Adım 1: Ham Veri Toplama
```python
# API'den son maçları al
def get_team_recent_matches_v3(team_id, match_count=10):
    """Takımın son 10 maçını API v3'ten çek"""
    
    url = "https://v3.football.api-sports.io/fixtures"
    params = {
        'team': team_id,
        'last': match_count,
        'status': 'FT'
    }
    
    # Raw match data
    raw_matches = [
        {
            'date': '2024-06-15',
            'home_team_id': 4700,
            'away_team_id': 8847,
            'home_goals': 2,
            'away_goals': 1,
            'halftime_home': 1,
            'halftime_away': 0,
            'venue': 'home',  # Bu takım için
            'result': 'W'     # Bu takım için
        },
        # ... diğer maçlar
    ]
```

#### Adım 2: Venue-Specific Form Analizi
```python
def analyze_team_form_by_venue(matches, target_venue='home'):
    """Ev sahibi veya deplasman formunu ayrı ayrı analiz et"""
    
    venue_matches = [m for m in matches if m['venue'] == target_venue]
    
    # Son 5 maç ağırlığı: 2.5x
    # Son 6-10 maç ağırlığı: 1.5x
    weights = []
    for i, match in enumerate(venue_matches[:10]):
        if i < 5:
            weights.append(2.5)
        else:
            weights.append(1.5)
    
    # Ağırlıklı gol ortalaması
    goals_scored = [m['goals_for'] for m in venue_matches]
    goals_conceded = [m['goals_against'] for m in venue_matches]
    
    weighted_goals_scored = sum(g * w for g, w in zip(goals_scored, weights)) / sum(weights)
    weighted_goals_conceded = sum(g * w for g, w in zip(goals_conceded, weights)) / sum(weights)
    
    return {
        'avg_goals_scored': weighted_goals_scored,
        'avg_goals_conceded': weighted_goals_conceded,
        'match_count': len(venue_matches),
        'form_coefficient': calculate_form_coefficient(venue_matches)
    }
```

#### Adım 3: Liga Ortalamaları ile Normalizasyon
```python
def calculate_league_adjusted_strength(team_form, league_averages):
    """Takım gücünü liga ortalamalarına göre normalize et"""
    
    # Liga ortalamaları (2024 sezon verileri)
    league_avg = {
        'home_goals': 1.53,      # Ev sahibi takımlar ortalama gol
        'away_goals': 1.21,      # Deplasman takımları ortalama gol
        'home_conceded': 1.21,   # Ev sahibi takımlar ortalama yenen gol
        'away_conceded': 1.53    # Deplasman takımları ortalama yenen gol
    }
    
    # Takım gücü faktörleri
    if team_form['venue'] == 'home':
        attack_strength = team_form['avg_goals_scored'] / league_avg['home_goals']
        defense_strength = league_avg['away_goals'] / team_form['avg_goals_conceded']
    else:
        attack_strength = team_form['avg_goals_scored'] / league_avg['away_goals']
        defense_strength = league_avg['home_goals'] / team_form['avg_goals_conceded']
    
    return {
        'attack_strength': min(2.5, max(0.3, attack_strength)),  # 0.3-2.5 arası sınırla
        'defense_strength': min(2.5, max(0.3, defense_strength))
    }
```

### 2. Bayesian Lambda Hesaplama Algoritması

#### Lambda Değerleri Hesaplama
```python
def calculate_bayesian_lambdas(home_form, away_form, league_averages):
    """Poisson dağılımı için lambda değerlerini hesapla"""
    
    # Takım gücü faktörlerini al
    home_strength = calculate_league_adjusted_strength(home_form, league_averages)
    away_strength = calculate_league_adjusted_strength(away_form, league_averages)
    
    # Ev sahibi avantajı faktörü
    home_advantage = 1.15  # %15 ev sahibi avantajı
    
    # Lambda hesaplamaları
    home_lambda = (
        league_averages['home_goals'] * 
        home_strength['attack_strength'] * 
        away_strength['defense_strength'] * 
        home_advantage
    )
    
    away_lambda = (
        league_averages['away_goals'] * 
        away_strength['attack_strength'] * 
        home_strength['defense_strength']
    )
    
    # Aşırı değerleri sınırla
    home_lambda = min(4.0, max(0.2, home_lambda))
    away_lambda = min(4.0, max(0.2, away_lambda))
    
    return {
        'home_lambda': home_lambda,
        'away_lambda': away_lambda,
        'home_expected_goals': home_lambda,
        'away_expected_goals': away_lambda
    }
```

### 3. Monte Carlo Simülasyon Detayları

#### Simülasyon Algoritması
```python
def monte_carlo_exact_score_simulation(home_lambda, away_lambda, home_team_id, away_team_id):
    """10,000 simülasyon ile kesin skor olasılıklarını hesapla"""
    
    import random
    import math
    
    # Deterministic seed - aynı takımlar her zaman aynı sonucu verir
    seed = (int(home_team_id) * 1000 + int(away_team_id)) % 2147483647
    random.seed(seed)
    
    # Simülasyon sonuçları
    score_frequencies = {}
    total_simulations = 10000
    
    # Poisson dağılımı fonksiyonu
    def poisson_random(lambda_val):
        """Poisson dağılımından rastgele sayı üret"""
        if lambda_val <= 0:
            return 0
        
        L = math.exp(-lambda_val)
        k = 0
        p = 1.0
        
        while p > L:
            k += 1
            p *= random.random()
        
        return k - 1
    
    # 10,000 simülasyon yap
    for _ in range(total_simulations):
        home_goals = poisson_random(home_lambda)
        away_goals = poisson_random(away_lambda)
        
        # Maksimum gol sınırı (gerçekçilik için)
        home_goals = min(8, home_goals)
        away_goals = min(8, away_goals)
        
        score = f"{home_goals}-{away_goals}"
        score_frequencies[score] = score_frequencies.get(score, 0) + 1
    
    # Olasılıkları hesapla ve sırala
    score_probabilities = {}
    for score, freq in score_frequencies.items():
        score_probabilities[score] = (freq / total_simulations) * 100
    
    # En olası skorları sırala
    sorted_scores = sorted(score_probabilities.items(), key=lambda x: x[1], reverse=True)
    
    return {
        'exact_scores': dict(sorted_scores[:20]),  # İlk 20 en olası skor
        'most_likely_score': sorted_scores[0][0] if sorted_scores else "1-1",
        'most_likely_probability': sorted_scores[0][1] if sorted_scores else 15.0
    }
```

### 4. Teorik Poisson Hesaplamaları

#### Teorik Skor Olasılıkları
```python
def calculate_theoretical_poisson_scores(home_lambda, away_lambda):
    """Teorik Poisson dağılımı ile skor olasılıklarını hesapla"""
    
    import math
    
    def poisson_probability(k, lambda_val):
        """Poisson olasılık hesaplama"""
        if lambda_val <= 0:
            return 0.0
        return (math.exp(-lambda_val) * (lambda_val ** k)) / math.factorial(k)
    
    theoretical_scores = {}
    
    # 0-6 gol arası kombinasyonları hesapla
    for home_goals in range(7):
        for away_goals in range(7):
            home_prob = poisson_probability(home_goals, home_lambda)
            away_prob = poisson_probability(away_goals, away_lambda)
            
            combined_prob = home_prob * away_prob * 100
            score = f"{home_goals}-{away_goals}"
            theoretical_scores[score] = combined_prob
    
    # En olası skorları sırala
    sorted_theoretical = sorted(theoretical_scores.items(), key=lambda x: x[1], reverse=True)
    
    return {
        'theoretical_scores': dict(sorted_theoretical[:15]),
        'theoretical_most_likely': sorted_theoretical[0][0],
        'theoretical_probability': sorted_theoretical[0][1]
    }
```

### 5. Model Kombinasyon ve Ağırlıklandırma

#### Hibrit Skor Tahmini
```python
def combine_score_predictions(monte_carlo_result, theoretical_result, confidence_factors):
    """Monte Carlo ve teorik tahminleri birleştir"""
    
    # Model güven katsayıları
    monte_carlo_weight = 0.7  # %70 Monte Carlo ağırlığı
    theoretical_weight = 0.3  # %30 teorik ağırlık
    
    # Güven faktörlerine göre ağırlık ayarlama
    if confidence_factors['data_quality'] < 0.6:  # Yetersiz veri varsa
        monte_carlo_weight = 0.5
        theoretical_weight = 0.5
    
    combined_scores = {}
    
    # Tüm skorları birleştir
    all_scores = set(monte_carlo_result['exact_scores'].keys()) | set(theoretical_result['theoretical_scores'].keys())
    
    for score in all_scores:
        mc_prob = monte_carlo_result['exact_scores'].get(score, 0)
        theo_prob = theoretical_result['theoretical_scores'].get(score, 0)
        
        # Ağırlıklı kombinasyon
        combined_prob = (mc_prob * monte_carlo_weight) + (theo_prob * theoretical_weight)
        combined_scores[score] = combined_prob
    
    # En olası skoru bul
    most_likely_score = max(combined_scores.items(), key=lambda x: x[1])
    
    return {
        'final_exact_score': most_likely_score[0],
        'final_probability': round(most_likely_score[1], 2),
        'all_score_probabilities': dict(sorted(combined_scores.items(), key=lambda x: x[1], reverse=True)[:10])
    }
```

### 6. Form Katsayısı Hesaplama

#### Detaylı Form Analizi
```python
def calculate_detailed_form_coefficient(recent_matches):
    """Son maçlara dayalı detaylı form katsayısı hesapla"""
    
    form_points = 0
    total_weight = 0
    momentum_factor = 1.0
    
    # Her maç için form puanı hesapla
    for i, match in enumerate(recent_matches[:10]):
        # Zaman ağırlığı - son maçlar daha önemli
        time_weight = 2.5 if i < 3 else (1.8 if i < 6 else 1.0)
        
        # Sonuç puanı
        if match['result'] == 'W':
            result_points = 3
        elif match['result'] == 'D':
            result_points = 1
        else:
            result_points = 0
        
        # Gol farkı bonusu/cezası
        goal_diff = match['goals_for'] - match['goals_against']
        goal_diff_bonus = min(1.0, abs(goal_diff) * 0.2)
        if goal_diff > 0:
            result_points += goal_diff_bonus
        elif goal_diff < 0:
            result_points -= goal_diff_bonus
        
        # Rakip kalitesi faktörü (gelişmiş hesaplama gerekir)
        opponent_quality = estimate_opponent_quality(match['opponent_id'])
        quality_multiplier = 0.8 + (opponent_quality * 0.4)  # 0.8-1.2 arası
        
        # Ağırlıklı puan ekle
        weighted_points = result_points * time_weight * quality_multiplier
        form_points += weighted_points
        total_weight += time_weight
    
    # Momentum hesaplama (son 3 maçın trendi)
    if len(recent_matches) >= 3:
        recent_results = [1 if m['result'] == 'W' else (0.5 if m['result'] == 'D' else 0) for m in recent_matches[:3]]
        momentum_trend = (recent_results[0] * 0.5) + (recent_results[1] * 0.3) + (recent_results[2] * 0.2)
        momentum_factor = 0.8 + (momentum_trend * 0.4)
    
    # Final form katsayısı (0-1 arası normalize)
    form_coefficient = (form_points / total_weight) / 3.0  # 3.0 maksimum puan
    form_coefficient *= momentum_factor
    
    return min(1.0, max(0.1, form_coefficient))
```

### 7. Kesin Skor Güven Seviyesi

#### Tahmin Güvenilirlik Analizi
```python
def calculate_prediction_confidence(home_form, away_form, lambda_values):
    """Tahmin güvenilirlik seviyesini hesapla"""
    
    confidence_factors = {
        'data_sufficiency': 1.0,
        'form_stability': 1.0,
        'lambda_reliability': 1.0,
        'variance_control': 1.0
    }
    
    # Veri yeterliliği kontrolü
    min_matches = min(home_form['match_count'], away_form['match_count'])
    confidence_factors['data_sufficiency'] = min(1.0, min_matches / 8.0)
    
    # Form istikrarı (son maçlardaki tutarlılık)
    home_variance = calculate_goal_variance(home_form['recent_goals'])
    away_variance = calculate_goal_variance(away_form['recent_goals'])
    avg_variance = (home_variance + away_variance) / 2
    confidence_factors['form_stability'] = max(0.3, 1.0 - (avg_variance / 4.0))
    
    # Lambda değer güvenilirliği
    lambda_sum = lambda_values['home_lambda'] + lambda_values['away_lambda']
    if 1.5 <= lambda_sum <= 4.0:  # Optimal lambda aralığı
        confidence_factors['lambda_reliability'] = 1.0
    else:
        confidence_factors['lambda_reliability'] = 0.7
    
    # Genel güven seviyesi
    overall_confidence = (
        confidence_factors['data_sufficiency'] * 0.4 +
        confidence_factors['form_stability'] * 0.3 +
        confidence_factors['lambda_reliability'] * 0.3
    )
    
    return {
        'confidence_score': overall_confidence,
        'confidence_level': 'high' if overall_confidence > 0.75 else ('medium' if overall_confidence > 0.5 else 'low'),
        'factors': confidence_factors
    }
```

### 8. Final Kesin Skor Seçimi

#### Algoritma Karar Mekanizması
```python
def select_final_exact_score(combined_predictions, confidence_analysis):
    """Final kesin skoru seç ve doğrula"""
    
    candidate_score = combined_predictions['final_exact_score']
    candidate_probability = combined_predictions['final_probability']
    
    # Güven seviyesi düşükse, daha konservatif skor seç
    if confidence_analysis['confidence_score'] < 0.6:
        # Düşük skorlu maçları tercih et
        conservative_scores = ['1-1', '1-0', '2-1', '0-1', '2-0']
        for score in conservative_scores:
            if score in combined_predictions['all_score_probabilities']:
                candidate_score = score
                candidate_probability = combined_predictions['all_score_probabilities'][score]
                break
    
    # Aşırı yüksek skorları filtrele
    home_goals, away_goals = map(int, candidate_score.split('-'))
    total_goals = home_goals + away_goals
    
    if total_goals > 5:  # 5+ gol çok nadir
        # Daha makul bir skor bul
        reasonable_scores = [s for s in combined_predictions['all_score_probabilities'].keys() 
                           if sum(map(int, s.split('-'))) <= 4]
        if reasonable_scores:
            candidate_score = reasonable_scores[0]
            candidate_probability = combined_predictions['all_score_probabilities'][candidate_score]
    
    return {
        'exact_score': candidate_score,
        'probability': round(candidate_probability, 1),
        'confidence': confidence_analysis['confidence_level'],
        'alternative_scores': list(combined_predictions['all_score_probabilities'].keys())[:5]
    }
```

### 9. Algoritma Ağırlıklandırma Tablosu

#### Model Ağırlık Dağılımı
```
Gol Beklentisi Hesaplama:
├── Son 3 Maç Ağırlığı: %50 (2.5x multiplier)
├── Son 6-10 Maç Ağırlığı: %30 (1.5x multiplier)  
├── Liga Normalizasyonu: %20 (sabit faktör)
└── Ev Sahibi Avantajı: %15 bonus

Kesin Skor Tahmini:
├── Monte Carlo Simülasyonu: %70
├── Teorik Poisson: %30
├── Form Katsayısı Etkisi: %40
└── Güven Seviyesi Ayarı: %20

Lambda Hesaplama:
├── Saldırı Gücü: %40
├── Savunma Gücü: %40  
├── Ev Sahibi Faktörü: %15
└── Momentum Etkisi: %5
```

Bu detaylı algoritma hiyerarşisi, sistemin takım gol beklentilerini ve kesin skorları nasıl hesapladığını tam olarak açıklar.

## Karşılaşılan Kritik Sistem Hataları

### 1. libstdc++.so.6 Kütüphane Hatası

**Problem:**
```
ImportError: libstdc++.so.6: cannot open shared object file: No such file or directory
```

**Hata Nedeni:**
- Replit ortamında C++ standart kütüphanesi eksikti
- Python'da NumPy, pandas, scikit-learn gibi paketler C++ bağımlılıkları gerektirir
- Bu kütüphane olmadan ML paketleri yüklenemez

**Çözüm Süreci:**
1. Sistem seviyesinde C++ kütüphanelerini yükledik
2. Python paketlerini yeniden kurulumunu gerçekleştirdik
3. Ortam değişkenlerini düzenledik

**Workflow Etkisi:**
```
gunicorn başlangıç → Python import → NumPy yükleme → 
libstdc++.so.6 arama → Bulunamadı → ImportError → 
Worker process crash → Workflow tamamen durdu
```

### 2. Pandas/NumPy Import Hataları

**Problem:**
```
ModuleNotFoundError: No module named 'pandas'
ImportError: numpy.core.multiarray failed to import
```

**Hata Nedeni:**
- Python paketleri eksik veya uyumsuz sürümlerdi
- Bağımlılık çakışmaları vardı
- C++ kütüphanesi eksikliği zincir reaksiyon yarattı

**Çözüm:**
- Tüm Python paketlerini temiz kurulum
- Uyumlu sürümlerin seçilmesi
- requirements.txt dosyasının güncellenmesi

### 3. JavaScript Veri Yapısı Uyumsuzluğu

**Problem:**
```
Uncaught TypeError: Cannot read properties of undefined (reading 'home')
```

**Hata Nedeni:**
- Frontend JavaScript kodu `data.predictions.match_winner.home` arıyordu
- Backend API yanıtında `data.predictions.match_winner.home_win` vardı
- Veri yapısı tutarsızlığı

**Çözüm Süreci:**
1. API yanıt yapısını frontend beklentileriyle uyumlu hale getirdik
2. Fallback mekanizmaları ekledik
3. Çakışan JavaScript dosyalarını düzenledik

## Uygulanan Çözümler

### 1. Backend API Yapısı Düzeltmeleri

**Önce (Hatalı):**
```python
"predictions": {
    "match_winner": {
        "home_win": 0.4,  # JavaScript bunu bulamıyordu
        "draw": 0.3,
        "away_win": 0.3
    }
}
```

**Sonra (Düzeltilmiş):**
```python
"predictions": {
    "betting_predictions": {
        "both_teams_to_score": {"prediction": "KG VAR", "probability": 55.0},
        "over_2_5_goals": {"prediction": "2.5 ÜST", "probability": 60.0}
    },
    "match_winner": {
        "home_win": 0.4,
        "draw": 0.3, 
        "away_win": 0.3
    }
},
"home_win_prob": 40.0,  # Fallback değer
"most_likely_outcome": "HOME_WIN"  # Frontend için gerekli
```

### 2. JavaScript Hata Düzeltmeleri

**Problem Kodu:**
```javascript
// Bu satır hataya neden oluyordu
const homeProb = Math.round(data.predictions.match_winner.home_win * 100);
```

**Çözüm Kodu:**
```javascript
// Fallback mekanizması eklendi
if (data.predictions && data.predictions.match_winner) {
    const homeProb = Math.round(data.predictions.match_winner.home_win * 100);
    updateProbabilityBars(homeProb, drawProb, awayProb);
} else if (data.home_win_prob !== undefined) {
    // Backend'den doğrudan olasılık verileri
    updateProbabilityBars(data.home_win_prob, data.draw_prob, data.away_win_prob);
}
```

### 3. Cache Problemlerinin Çözümü

**Problem:** Eski JavaScript kodları browser cache'inde kalıyordu

**Çözüm:** Version parametreleri eklendi
```html
<script src="{{ url_for('static', filename='js/fixed_custom.js') }}?v=2"></script>
```

## Sistem Mimarisi

### API Entegrasyonu
- **API Source:** API Football v3
- **Endpoint:** `/api/predict-match/{home_id}/{away_id}`
- **Response Format:** JSON with comprehensive prediction data

### Tahmin Modülleri
1. **Match Prediction:** Temel maç sonucu tahminleri
2. **Betting Predictions:** Bahis tahminleri (KG VAR/YOK, ÜST/ALT)
3. **Team Analysis:** Takım form ve istatistik analizi

### Frontend Komponenleri
- **Prediction Modal:** Tahmin popup'ı
- **Team Stats:** Takım istatistikleri
- **Match Display:** Maç listesi ve görüntüleme

## Dosya Yapısı

```
├── main.py                 # Ana Flask uygulaması
├── football_api_config.py  # API konfigürasyonu
├── api_routes.py          # API endpoint'leri
├── templates/
│   ├── base.html          # Ana template
│   ├── index.html         # Maç listesi
│   └── fixtures.html      # Fikstür sayfası
├── static/js/
│   ├── fixed_custom.js    # Ana tahmin işleyici
│   ├── prediction-handler.js  # Yedek tahmin işleyici
│   └── custom.js          # Genel JavaScript
└── static/css/
    └── style.css          # Ana stil dosyası
```

## Kritik Öğrenimler

### 1. Sistem Bağımlılıkları
- Tek bir eksik kütüphane tüm sistemi durdurabilir
- C++ bağımlılıkları Python ML paketleri için kritik
- Bağımlılık yönetimi proaktif olmalı

### 2. Frontend-Backend Uyumu
- API yanıt yapısı frontend beklentileriyle tam uyumlu olmalı
- Fallback mekanizmaları her zaman bulunmalı
- Veri yapısı değişiklikleri dikkatli planlanmalı

### 3. Cache Yönetimi
- JavaScript değişiklikleri cache nedeniyle etkili olmayabilir
- Version parametreleri cache problemlerini önler
- Browser cache development sürecini yavaşlatabilir

## Gelecek Geliştirmeler

1. **Hata Yönetimi:** Daha kapsamlı error handling
2. **API Failover:** Yedek API kaynaklarının entegrasyonu
3. **Caching Strategy:** Redis ile gelişmiş önbellek sistemi
4. **Model Training:** Gerçek zamanlı model eğitimi
5. **Performance:** API yanıt sürelerinin optimizasyonu

## Kurulum Talimatları

```bash
# Sistem bağımlılıkları
pip install -r requirements.txt

# Ortam değişkenleri
export APIFOOTBALL_PREMIUM_KEY="your_api_key"

# Uygulama başlatma
gunicorn --bind 0.0.0.0:5000 --reuse-port --reload main:app
```

## API Kullanımı

### Tahmin Endpoint'i
```
GET /api/predict-match/{home_team_id}/{away_team_id}
Parameters:
- home_name: Ev sahibi takım adı
- away_name: Deplasman takım adı
- force_update: Cache'i zorla yenile (boolean)
```

### Yanıt Formatı
```json
{
  "home_team": {"id": "123", "name": "Team A"},
  "away_team": {"id": "456", "name": "Team B"},
  "most_likely_outcome": "HOME_WIN",
  "predictions": {
    "betting_predictions": {
      "both_teams_to_score": {"prediction": "KG VAR", "probability": 55.0},
      "over_2_5_goals": {"prediction": "2.5 ÜST", "probability": 60.0}
    }
  }
}
```

---

**Son Güncelleme:** 19 Haziran 2025
**Versiyon:** 1.2.0
**Durum:** Aktif geliştirme